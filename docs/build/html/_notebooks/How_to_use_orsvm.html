<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>How to Fit a model &mdash; orsvm 1.0.5 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="How to use a prefitted model" href="How_to_use_prefitted_model.html" />
    <link rel="prev" title="Credits" href="../credits.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> orsvm
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../credits.html">Credits</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How to:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">How to Fit a model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Load-data-set">Load data-set</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Initialize-a-model">Initialize a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Kernel-Initialization">Kernel Initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Fit-the-model-and-Capture-paramaters">Fit the model and Capture paramaters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Weight-array">Weight array</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Support-Vectors">Support Vectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Bias">Bias</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Kernel-Instance">Kernel Instance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Inspect-the-model’s-accuracy">Inspect the model’s accuracy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Save-the-fitted-model-to-Json-file">Save the fitted model to Json file</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="How_to_use_prefitted_model.html">How to use a prefitted model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Legendre_fitting.html">Fit data-set using Legendre Kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="Chebyshev_fitting.html">Fit data-set using Chebyshev Kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="Gegenbauer_fitting.html">Fit data-set using Gegenbauer Kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="Jacobi_fitting.html">Fit data-set using Jacobi Kernel</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">orsvm</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">How to Fit a model</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/_notebooks/How_to_use_orsvm.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="How-to-Fit-a-model">
<h1>How to Fit a model<a class="headerlink" href="#How-to-Fit-a-model" title="Permalink to this heading"></a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">orsvm</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
<section id="Load-data-set">
<h2>Load data-set<a class="headerlink" href="#Load-data-set" title="Permalink to this heading"></a></h2>
<p>Import data set to a pandas Dataframe and convert to numpy or directly use numpy. Here we’ve imported monks data set from <a class="reference external" href="https://archive.ics.uci.edu/ml/datasets/MONK%27s+Problems">UCI</a>. Monk’s data set is already splitted into train and test sets, but for data sets which train/test sets are not splitted, you need to do the task by your own or use for example <a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html">train_test_split</a> from
scikit-learn. Please note that preprocessing steps such as Nan or null values handling, is sugested to be done before model initiation of orsvm.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fitting a model requires the data-set to be prepared, in order to be a binary classification.</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;D:\IPM\ORSVM\DataSets\DataSets\Classification\monks-problems\monks1_train.csv&#39;</span><span class="p">)</span>


<span class="n">y_train</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>         <span class="c1"># convert y_train to numpy array</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># drop the class label</span>
<span class="n">X_train</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>                  <span class="c1"># convert x_train to numpy array</span>


<span class="c1"># load test-set</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;D:\IPM\ORSVM\DataSets\DataSets\Classification\monks-problems\monks1_test.csv&#39;</span><span class="p">)</span>

<span class="n">y_test</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>           <span class="c1"># y_test: labels of the test</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># drop label column</span>
<span class="n">X_test</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Initialize-a-model">
<h2>Initialize a model<a class="headerlink" href="#Initialize-a-model" title="Permalink to this heading"></a></h2>
<p>Initializing a model is straight forward: 1. import orsvm 2. call Model class from orsvm by passing the kernel name and related parameters.</p>
<p>Required parameters are related to the chosen kernel. <code class="docutils literal notranslate"><span class="pre">Model</span></code> receives following parameters: 1. <strong>kernel</strong>, of type <code class="docutils literal notranslate"><span class="pre">String</span></code>, and is the kernel name and currently possible value are: <code class="docutils literal notranslate"><span class="pre">Chebyshev</span></code>, <code class="docutils literal notranslate"><span class="pre">Legendre</span></code>, <code class="docutils literal notranslate"><span class="pre">Gegenbauer</span></code>, <code class="docutils literal notranslate"><span class="pre">Jacobi</span></code> ,<code class="docutils literal notranslate"><span class="pre">rbf</span></code>.</p>
<ol class="arabic simple" start="2">
<li><p><strong>order</strong>,of type <code class="docutils literal notranslate"><span class="pre">int</span></code>, and is the order of orthogonal kernel function.</p></li>
<li><p><strong>T</strong>, of type <code class="docutils literal notranslate"><span class="pre">float</span></code>, and is the order transformation a.k.a. fractionality order. Valid range is <code class="docutils literal notranslate"><span class="pre">(0,1]</span></code>, as if it’s less then 1, that’s the fractional form of the kernel of fractional order of equal to T.</p></li>
<li><p><strong>KernelParam1</strong>, of type <code class="docutils literal notranslate"><span class="pre">float</span></code>, and is only applicable for <code class="docutils literal notranslate"><span class="pre">Jacobi</span></code> and <code class="docutils literal notranslate"><span class="pre">Gegenbauer</span></code> and <code class="docutils literal notranslate"><span class="pre">rbf</span></code> kernels. In case of <code class="docutils literal notranslate"><span class="pre">jacobi</span></code> it refers to <code class="docutils literal notranslate"><span class="pre">psi</span></code> and in case of <code class="docutils literal notranslate"><span class="pre">Gegenbauer</span></code> it refers to <code class="docutils literal notranslate"><span class="pre">lambda</span></code> and in case of <code class="docutils literal notranslate"><span class="pre">rbf</span></code> it refers to <code class="docutils literal notranslate"><span class="pre">gamma</span></code>. Valid range for <code class="docutils literal notranslate"><span class="pre">psi</span></code> is greater than -1 and valid range for <code class="docutils literal notranslate"><span class="pre">lambda</span></code> is greater than -0.5 and valid range for <code class="docutils literal notranslate"><span class="pre">gamma</span></code> is greater than zero.</p></li>
<li><p><strong>KernelParam2</strong>, of type <code class="docutils literal notranslate"><span class="pre">float</span></code>, and is only applicable to <code class="docutils literal notranslate"><span class="pre">Jacobi</span></code> kernel and refers to second hyperparameter of that kernel <code class="docutils literal notranslate"><span class="pre">omega</span></code>. Valid range is greater than -1.</p></li>
<li><p><strong>svd</strong>, of types <code class="docutils literal notranslate"><span class="pre">int</span></code> , <code class="docutils literal notranslate"><span class="pre">scientific</span> <span class="pre">number</span></code> ,<code class="docutils literal notranslate"><span class="pre">char</span></code>.</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">int</span></code>, by setting an integer value user chooses how many of Lagrange multipliers to be considered as support vectors.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scientific</span> <span class="pre">number</span></code>, User may choose a minimun threshold to choose support vectors from lagrange multipliers. In this case, the passed argument must be in scientific notation for example 1e-3, chooses all Lagrange multipliers that are greater than ‘1e-3’(0.001).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">a</span></code>, represents the average, ORSVM will compute the average of scientific notation of the scale that lagrange multipliers are in, and sets as the criteria to select the ones that are greater than average. Choosing the “average” may cause most of lagrange multipliers to be selected as support vectors! and this may lead to poor generalization of the fitting result! but the benefit of this one is whenever the user may not know how to choose the threshold, choosing the wrong threshold may
outcomes 0 support vectors, therefore setting svd = ‘a’ for the first fitting attempt gives an intuition to choose the best value.</p></li>
</ol>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">form</span></code>, of type char, can be one of ‘r’ or ‘e’, for recursive and explicit, respectively. Only applicable to Chebyshev kernel.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">c</span></code>, of type int, is the regulization parametr is SVM algorithm. The default is None. Possible values: 10, 100, 1000</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">noise</span></code>, A noise only applicable to weight function of Jacobi kernel. recommended values can be 0.1, 0.01,…</p></li>
</ol>
<p>According to selected kernel, user may pass related parameters. For an example here we’ll initiate the model with Legendre kernel, that only reuires order and T.</p>
</section>
<section id="Kernel-Initialization">
<h2>Kernel Initialization<a class="headerlink" href="#Kernel-Initialization" title="Permalink to this heading"></a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an object from Model class of ORSVM</span>
<span class="n">obj</span><span class="o">=</span><span class="n">orsvm</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s2">&quot;Legendre&quot;</span><span class="p">,</span><span class="n">order</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">T</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Fit-the-model-and-Capture-paramaters">
<h2>Fit the model and Capture paramaters<a class="headerlink" href="#Fit-the-model-and-Capture-paramaters" title="Permalink to this heading"></a></h2>
<p>Fit the model by calling the ModelFit method, and capture the parameters of the SVM equation. These parameters can be saved for later use.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fit the model and Capture parameters</span>
<span class="n">Weights</span><span class="p">,</span> <span class="n">SupportVectors</span><span class="p">,</span> <span class="n">Bias</span><span class="p">,</span> <span class="n">KernelInstance</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">ModelFit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2022-11-22 21:16:08,759:INFO:** ORSVM kernel: legendre
2022-11-22 21:16:08,761:INFO:** Order: 4
2022-11-22 21:16:08,763:INFO:** Fractional mode, transition : 0.3
2022-11-22 21:16:10,536:INFO:** Average method for support vector determination selected!
2022-11-22 21:16:10,541:INFO:** support vector threshold: 10^-6
2022-11-22 21:16:10,673:INFO:Kenrel matrix is convex
2022-11-22 21:16:10,677:INFO:** solution status: optimal
</pre></div></div>
</div>
<section id="Weight-array">
<h3>Weight array<a class="headerlink" href="#Weight-array" title="Permalink to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Weights</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([4.31616233e-05, 3.89142170e-05, 3.17406317e-04, 1.21298781e-03,
       2.26153630e-03, 9.46278728e-04, 4.48721425e-04, 1.55539798e-04,
       1.76994177e-03, 9.74950658e-04, 6.60982882e-05, 3.33188669e-03,
       1.17478909e-03, 1.36909791e-03, 1.91821866e-03, 9.56413563e-05,
       6.20364081e-05, 1.47440492e-03, 5.30630721e-04, 1.09339305e-04,
       5.52046728e-04, 2.80712857e-03, 2.65326106e-03, 6.43361900e-04,
       4.82953952e-04, 2.39357351e-03, 1.28777105e-06, 1.65828539e-04,
       1.51709459e-04, 9.23363273e-03, 2.05142062e-02, 1.10989496e-01,
       2.55213384e-02, 9.59451474e-03, 3.29399755e-03, 1.03252221e-03,
       1.99687458e-02, 9.61922898e-02, 6.46303906e-04, 5.39030946e-04,
       1.58653037e-02, 2.79692699e-02, 2.47487466e-04, 1.03700941e-03,
       4.04852964e-04, 1.31887063e-04, 3.99202585e-04, 2.52186718e-02,
       8.14330077e-04, 1.03097010e-01, 6.38327703e-04, 1.27344896e-02,
       6.66340171e-03, 8.89939033e-05, 1.92628687e-02, 4.75350555e-03,
       1.77760937e-03, 8.99825443e-02, 1.02012638e-03, 1.34319496e-02,
       1.06050364e-02, 5.91328073e-03])
</pre></div></div>
</div>
</section>
<section id="Support-Vectors">
<h3>Support Vectors<a class="headerlink" href="#Support-Vectors" title="Permalink to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SupportVectors</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[-1.        , -1.        , -1.        , -1.        ,  0.77093499,
        -1.        ],
       [-1.        , -1.        , -1.        , -1.        ,  0.77093499,
         0.43844619],
       [-1.        , -1.        , -1.        ,  0.77093499,  0.43844619,
        -1.        ],
       [-1.        , -1.        , -1.        ,  0.77093499,  0.77093499,
         0.43844619],
       [-1.        , -1.        ,  0.43844619, -1.        ,  0.43844619,
         0.43844619],
       [-1.        , -1.        ,  0.43844619,  0.43844619,  0.77093499,
        -1.        ],
       [-1.        , -1.        ,  0.43844619,  0.43844619,  1.        ,
        -1.        ],
       [-1.        ,  0.43844619, -1.        , -1.        ,  0.43844619,
        -1.        ],
       [-1.        ,  0.43844619, -1.        ,  0.43844619,  0.77093499,
         0.43844619],
       [-1.        ,  0.43844619, -1.        ,  0.77093499,  0.43844619,
        -1.        ],
       [-1.        ,  0.43844619, -1.        ,  0.77093499,  1.        ,
         0.43844619],
       [-1.        ,  0.43844619,  0.43844619, -1.        ,  0.43844619,
         0.43844619],
       [-1.        ,  0.43844619,  0.43844619,  0.43844619,  0.77093499,
         0.43844619],
       [-1.        ,  0.43844619,  0.43844619,  0.43844619,  1.        ,
        -1.        ],
       [-1.        ,  0.43844619,  0.43844619,  0.77093499,  0.43844619,
         0.43844619],
       [-1.        ,  0.43844619,  0.43844619,  0.77093499,  0.77093499,
        -1.        ],
       [-1.        ,  0.77093499, -1.        ,  0.77093499, -1.        ,
         0.43844619],
       [-1.        ,  0.77093499,  0.43844619,  0.43844619, -1.        ,
         0.43844619],
       [-1.        ,  0.77093499,  0.43844619,  0.77093499, -1.        ,
        -1.        ],
       [ 0.43844619, -1.        , -1.        , -1.        ,  0.77093499,
         0.43844619],
       [ 0.43844619, -1.        , -1.        ,  0.43844619, -1.        ,
         0.43844619],
       [ 0.43844619, -1.        , -1.        ,  0.43844619,  0.43844619,
         0.43844619],
       [ 0.43844619, -1.        ,  0.43844619, -1.        ,  0.43844619,
         0.43844619],
       [ 0.43844619, -1.        ,  0.43844619, -1.        ,  0.77093499,
        -1.        ],
       [ 0.43844619, -1.        ,  0.43844619, -1.        ,  1.        ,
         0.43844619],
       [ 0.43844619, -1.        ,  0.43844619,  0.43844619,  0.77093499,
        -1.        ],
       [ 0.43844619, -1.        ,  0.43844619,  0.43844619,  1.        ,
         0.43844619],
       [ 0.43844619, -1.        ,  0.43844619,  0.77093499,  0.43844619,
         0.43844619],
       [ 0.43844619, -1.        ,  0.43844619,  0.77093499,  1.        ,
        -1.        ],
       [ 0.43844619,  0.43844619, -1.        ,  0.43844619,  0.77093499,
         0.43844619],
       [ 0.43844619,  0.43844619, -1.        ,  0.77093499,  1.        ,
         0.43844619],
       [ 0.43844619,  0.43844619,  0.43844619, -1.        ,  0.77093499,
         0.43844619],
       [ 0.43844619,  0.43844619,  0.43844619,  0.43844619,  0.43844619,
        -1.        ],
       [ 0.43844619,  0.43844619,  0.43844619,  0.77093499,  1.        ,
        -1.        ],
       [ 0.43844619,  0.77093499, -1.        ,  0.43844619,  0.77093499,
        -1.        ],
       [ 0.43844619,  0.77093499, -1.        ,  0.77093499,  0.77093499,
        -1.        ],
       [ 0.43844619,  0.77093499, -1.        ,  0.77093499,  1.        ,
         0.43844619],
       [ 0.43844619,  0.77093499,  0.43844619, -1.        ,  0.77093499,
         0.43844619],
       [ 0.43844619,  0.77093499,  0.43844619,  0.43844619, -1.        ,
        -1.        ],
       [ 0.43844619,  0.77093499,  0.43844619,  0.43844619, -1.        ,
         0.43844619],
       [ 0.43844619,  0.77093499,  0.43844619,  0.43844619,  0.43844619,
        -1.        ],
       [ 0.43844619,  0.77093499,  0.43844619,  0.77093499,  0.77093499,
         0.43844619],
       [ 0.77093499, -1.        , -1.        , -1.        , -1.        ,
         0.43844619],
       [ 0.77093499, -1.        , -1.        ,  0.77093499,  0.43844619,
         0.43844619],
       [ 0.77093499, -1.        ,  0.43844619, -1.        , -1.        ,
        -1.        ],
       [ 0.77093499, -1.        ,  0.43844619,  0.43844619,  0.43844619,
         0.43844619],
       [ 0.77093499, -1.        ,  0.43844619,  0.77093499,  0.43844619,
         0.43844619],
       [ 0.77093499,  0.43844619, -1.        ,  0.43844619,  1.        ,
         0.43844619],
       [ 0.77093499,  0.43844619,  0.43844619, -1.        , -1.        ,
         0.43844619],
       [ 0.77093499,  0.43844619,  0.43844619, -1.        ,  0.77093499,
         0.43844619],
       [ 0.77093499,  0.43844619,  0.43844619,  0.77093499, -1.        ,
        -1.        ],
       [ 0.77093499,  0.43844619,  0.43844619,  0.77093499,  0.43844619,
        -1.        ],
       [ 0.77093499,  0.43844619,  0.43844619,  0.77093499,  1.        ,
        -1.        ],
       [ 0.77093499,  0.77093499, -1.        , -1.        ,  0.43844619,
        -1.        ],
       [ 0.77093499,  0.77093499, -1.        ,  0.43844619,  1.        ,
         0.43844619],
       [ 0.77093499,  0.77093499, -1.        ,  0.77093499,  0.43844619,
        -1.        ],
       [ 0.77093499,  0.77093499, -1.        ,  0.77093499,  1.        ,
         0.43844619],
       [ 0.77093499,  0.77093499,  0.43844619, -1.        ,  0.77093499,
         0.43844619],
       [ 0.77093499,  0.77093499,  0.43844619, -1.        ,  1.        ,
        -1.        ],
       [ 0.77093499,  0.77093499,  0.43844619,  0.77093499,  0.43844619,
         0.43844619],
       [ 0.77093499,  0.77093499,  0.43844619,  0.77093499,  0.77093499,
         0.43844619],
       [ 0.77093499,  0.77093499,  0.43844619,  0.77093499,  1.        ,
         0.43844619]])
</pre></div></div>
</div>
</section>
<section id="Bias">
<h3>Bias<a class="headerlink" href="#Bias" title="Permalink to this heading"></a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The bias of the hyperplane&#39;s equation</span>
<span class="n">Bias</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.2798437094039253
</pre></div></div>
</div>
</section>
<section id="Kernel-Instance">
<h3>Kernel Instance<a class="headerlink" href="#Kernel-Instance" title="Permalink to this heading"></a></h3>
<p>The kernel instance is the initiated orthogonal kernel function.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The fitted kernel model</span>
<span class="n">KernelInstance</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;orsvm.kernels.Legendre at 0x1eed8b59a48&gt;
</pre></div></div>
</div>
</section>
</section>
<section id="Inspect-the-model’s-accuracy">
<h2>Inspect the model’s accuracy<a class="headerlink" href="#Inspect-the-model’s-accuracy" title="Permalink to this heading"></a></h2>
<p>Model’s accuracy report is achievable in the end of fitting procedure. All metrics are from <code class="docutils literal notranslate"><span class="pre">sk_learn</span></code> package. ModelPredict funcyion is the last step, after loading data set and fitting procedure Model Prediction function</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">acc</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">ModelPredict</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_test</span><span class="p">,</span><span class="n">Bias</span><span class="p">,</span><span class="n">KernelInstance</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2022-11-22 21:16:26,935:INFO:** Accuracy score: 0.9328703703703703
2022-11-22 21:16:26,962:INFO:** Classification Report:
               precision    recall  f1-score   support

          -1       0.95      0.91      0.93       216
           1       0.92      0.95      0.93       216

    accuracy                           0.93       432
   macro avg       0.93      0.93      0.93       432
weighted avg       0.93      0.93      0.93       432

2022-11-22 21:16:26,986:INFO:** Confusion Matrix:
 [[197  19]
 [ 10 206]]
</pre></div></div>
</div>
</section>
<section id="Save-the-fitted-model-to-Json-file">
<h2>Save the fitted model to Json file<a class="headerlink" href="#Save-the-fitted-model-to-Json-file" title="Permalink to this heading"></a></h2>
<p>The final result of the fitting procedure and the input arguments can be saved in a file with Jason format(dictionary in python). This can be used as a profiling method for multiple tests for later inspection or can be used for later classification tests without a need to perform fitting, as the results(Weights, SupportVectors, Bias, KernelInstance) are available to make the prediction. This can be very helpful for massive data sets. In this case, one should be cautious about the <a class="reference external" href="https://en.wikipedia.org/wiki/Drift_(data_science)">data
drift</a>. Here is a sample output of the SaveToJason (note that in the following line some values are deleted for ease of use, but is the real output file all values will be stored):</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;kernel&quot;</span><span class="p">:</span> <span class="s2">&quot;legendre&quot;</span><span class="p">,</span> <span class="s2">&quot;kernelParam1&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span> <span class="s2">&quot;kernelParam2&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span> <span class="s2">&quot;order&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;form&quot;</span><span class="p">:</span> <span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;noise&quot;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;fractional&quot;</span><span class="p">,</span> <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span> <span class="s2">&quot;transition&quot;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">,</span> <span class="s2">&quot;svd&quot;</span><span class="p">:</span> <span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="s2">&quot;support multipliers&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01677376965138039</span><span class="p">,</span> <span class="o">....</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.35288692631817387</span><span class="p">],</span> <span class="o">...</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.26458826100646937</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.43665534918999993</span><span class="p">,</span> <span class="mf">0.49129253988712085</span><span class="p">,</span> <span class="mf">0.6801829583501886</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5808258337897634</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.43665534918999993</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.43665534918999993</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.35288692631817387</span><span class="p">]],</span> <span class="s2">&quot;support vector labels&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">...</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">],</span> <span class="s2">&quot;weights&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">0.01677376965138039</span><span class="p">,</span> <span class="o">...</span> <span class="p">,</span> <span class="mf">0.1480172090047829</span><span class="p">],</span> <span class="s2">&quot;kernel matrix&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">,</span> <span class="s2">&quot;bias&quot;</span><span class="p">:</span> <span class="mf">31.760448267708107</span><span class="p">,</span> <span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="mf">0.9867986798679867</span><span class="p">,</span> <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;optimal&quot;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">obj</span><span class="o">.</span><span class="n">SaveToJason</span><span class="p">(</span><span class="s2">&quot;output.json&quot;</span><span class="p">,</span> <span class="n">Weights</span><span class="o">=</span><span class="n">Weights</span><span class="p">,</span> <span class="n">SupportVectors</span><span class="o">=</span><span class="n">SupportVectors</span><span class="p">,</span> <span class="n">Bias</span><span class="o">=</span><span class="n">Bias</span><span class="p">,</span> <span class="n">accuracy</span><span class="o">=</span><span class="n">acc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
2022-11-22 21:17:06,401:INFO:Results saved successfully
</pre></div></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../credits.html" class="btn btn-neutral float-left" title="Credits" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="How_to_use_prefitted_model.html" class="btn btn-neutral float-right" title="How to use a prefitted model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, A.Hadian, S.Nedaei, A.Azmoon, M.Akhavan, S.Amirshahi.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>